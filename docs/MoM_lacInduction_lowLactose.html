<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Thomas Julou" />


<title>lac induction at low lactose concentrations</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
      </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Single-cell analysis of the glucose/lactose diauxic shift</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Mother machine experiments
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="MoM_lacInduction_Lags_Estimation.html">Lags estimation</a>
    </li>
    <li>
      <a href="MoM_lacInduction_Controls.html">Controls</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="MoM_lacInduction_Native.html">Induction and memory of the native lac operon</a>
    </li>
    <li>
      <a href="MoM_lacInduction_PerturbRepressed.html">Perturbations of the repressed lac operon expression</a>
    </li>
    <li>
      <a href="MoM_lacInduction_lowLactose.html">lac induction at lower lactose concentrations</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="MoM_lacInduction_PopLagSimul.html">Simulation of population lags from distribution of single-cell lags</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Additional experiments
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="MoM_lacInduction_FLIM.html">Fluorescence lifetime experiments</a>
    </li>
    <li>
      <a href="MoM_lacInduction_diauxieGrowthCurves.html">Population lags in diauxie experiments</a>
    </li>
    <li>
      <a href="MoM_lacInduction_QMS.html">Identification of SMT candidates in MS data</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/julou/MoM_lacInduction">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore"><em>lac</em> induction at low lactose concentrations</h1>
<h4 class="author">Thomas Julou</h4>
<h4 class="date">11 October, 2020</h4>

</div>


<p>In order to assess how the sensitivity threshold (number of Lac proteins required to sense lactose) depends on the concentration of external lactose, we performed experiment at lower lactose concentration. Note that since we anticipate slower growth on lactose (and hence higher sensitivity to phototoxicity) and/or longer lags, we reduced the fluorescence excitation intensity 5-fold and the acquisition frequency 2-fold.</p>
<ul>
<li>at 0.001% lactose (200x less than our standard condition), we observe no growth after a switch to lactose in the DIMM.</li>
<li>we performed 2 experiments at 0.01% lactose (200x less than our standard condition) with various levels of preinduction with IPTG (3 pre-cultures per experiment; designed to extend the range of inherited LacZ-GFP at the switch to lactose in order to estimate the threshold).</li>
</ul>
<p>We checked that fluorescence time series don’t feature abherent patterns despite the corrections required by the change of illumination. Nonetheless, we note that modifying the illumination frequency (and intensity?) changes the photobleaching which is complicated to correct for on total fluorescence (only instantaneous production rates could be corrected in a straightforward way but we don’t use them in our analysis).</p>
<p>First thing to note is that short lags are spread over a slightly wider window, i.e. they can last up to 65 min.</p>
<pre class="r"><code># Let&#39;s look at the lags
mycells_switching %&gt;% ungroup %&gt;% 
  filter(!date %in% discarded_dates) %&gt;%
  filter(switch_idx==1) %&gt;% 
  filter(str_detect(condition, &#39;^switch_[0-9]+h$&#39;) | str_detect(condition, &#39;switch_lac001&#39;)) %&gt;% 
  mutate(date2=date, date2=ifelse(str_detect(condition, &#39;^switch_[0-9]+h$&#39;) &amp; !str_detect(condition, &#39;switch_lac001&#39;), NA, date2)) %&gt;% 
  mutate(condition=ifelse(str_detect(condition, &#39;^switch_[0-9]+h$&#39;) &amp; !str_detect(condition, &#39;switch_lac001&#39;), &#39;switch&#39;, as.character(condition)),
         condition=fct_rev(condition)) %&gt;% 
  mutate(lag=lag_200,
         lag=ifelse(!is.infinite(lag), lag, max(lag[is.finite(lag)])+60),
         lag=ifelse(is.na(lag), -1, lag)) %&gt;% 
  ggplot(aes(lag/60)) +
  facet_grid(condition~., scales=&#39;free_y&#39;, labeller=as_labeller(rename_conds)) +
  geom_vline(aes(xintercept=time), lty=&quot;dotted&quot;,
             data=tibble(condition=c(&quot;switch_lac001_6h&quot;, &quot;switch_lac001_10h&quot;, &quot;switch&quot;), time=c(65, 65, 50))) +
  # geom_freqpoly(aes(col=factor(date2), fill=factor(date2), group=date), alpha=.8, binwidth=6) +
  geom_histogram(aes(fill=factor(date2), group=date), alpha=.2, position=&#39;identity&#39;, binwidth=6) +
  geom_step_hist(aes(col=factor(date2), group=date), position=&#39;identity&#39;, binwidth=6) +
  xlim(-10, 240) +
  guides(col=&#39;none&#39;, fill=&#39;none&#39;) +
  labs(x=lac_lags_label) </code></pre>
<p><img src="MoM_lacInduction_lowLactose_files/figure-html/unnamed-chunk-3-1.svg" width="672" /></p>
<p>Let’s extract the ancestry lineage of cells for which a lag can be measured, and compute the inherited LacZ-GFP from the GFP level at the start of the glucose phase.</p>
<pre class="r"><code># LOOK AT ANCESTORS
mycells_switchingLow_memory &lt;- mycells_switching %&gt;% ungroup() %&gt;% 
  filter(str_detect(condition, &#39;switch_lac001&#39;)) %&gt;% 
  select(date, pos, gl, ugen, genealogy) %&gt;% 
  group_by(date, pos, gl, ugen, genealogy) %&gt;%
  # do(parents=get_all_parents_cid(.$genealogy))
  do(tibble(parent=c(get_all_parents_cid(.$genealogy), .$genealogy))) %&gt;% 
  inner_join(
    myframes %&gt;% ungroup() %&gt;% 
      filter(str_detect(condition, &#39;switch_lac001&#39;)) %&gt;% 
      filter(m_cycle==1, medium==&#39;glucose&#39;) %&gt;% 
      select(date, pos, gl, parent=genealogy, time_sec, parent_gfp=gfp_nb) %&gt;% 
      mutate(parent=str_replace(parent, &quot;:&quot;, &quot;&quot;)),
    by=c(&quot;date&quot;, &quot;pos&quot;, &quot;gl&quot;, &quot;parent&quot;) ) %&gt;% 
  mutate(divs_to_switch = str_length(genealogy) - str_length(parent) - 1) %&gt;% 
  nest(lineage=c(&#39;parent&#39;, &#39;time_sec&#39;, &#39;parent_gfp&#39;, &#39;divs_to_switch&#39;)) %&gt;% 
  left_join(
    mycells_switching %&gt;% ungroup() %&gt;% 
      filter(str_detect(condition, &#39;switch_lac001&#39;)),
    by=c(&quot;date&quot;, &quot;pos&quot;, &quot;gl&quot;, &quot;ugen&quot;, &quot;genealogy&quot;) ) %&gt;% 
  ungroup() %&gt;% 
  mutate(gfp_start = map_dbl(lineage, ~ filter(., time_sec &lt; 10*60) %&gt;% pull(parent_gfp) %&gt;% mean() ),
         # compute inherited LacZ-GFP as the average gfp in the first 2 hours (corrected for bleaching) divived by the dilution factor due to the bnumber of division since then (assumes no production since no IPTG and no degradation)
         # NB: it is critical to get the GFP absolute right here and we introduce a +60 offset to correct for day-today variation in fluo baseline (cf the analysis of autofluorescence in cells with long lags)
         gfp_inherit = map_dbl(lineage, function(.df){ # browser()
           .df %&gt;% mutate(divs_since_par = max(divs_to_switch)-divs_to_switch,
                          gfp_ini = (parent_gfp+60) * exp(5e-5*time_sec) * 2^divs_since_par) %&gt;% 
             filter(time_sec&lt;2*3600) %&gt;%
             # ggplot() + geom_path(aes(time_sec, gfp_ini, group=parent)) + expand_limits(y=0) + scale_x_hours()
             pull(gfp_ini) %&gt;% mean() %&gt;% 
             {. / 2^max(.df$divs_to_switch)}
           # return(0)
         }),
         fluo_focus = ifelse(
           (date == &#39;20190605&#39; &amp; pos == 0 &amp; gl %in% c(2, 9)) |
           (date == &#39;20190605&#39; &amp; pos == 1 &amp; gl %in% c(19)) |
           (date == &#39;20190605&#39; &amp; pos == 2 &amp; gl %in% c(12, 13)) |
           (date == &#39;20190605&#39; &amp; pos == 3 &amp; gl %in% c(2)) |
           (date == &#39;20190614&#39; &amp; pos == 1 &amp; gl %in% c(1, 17)),
           TRUE, FALSE),
  )

# mycells_switchingLow_memory %&gt;% 
#   group_by(date, pos, gl) %&gt;% 
#   summarise(n=n(), all=all(fluo_focus), any=any(!fluo_focus)) %&gt;% 
#   ungroup() %&gt;% 
#   summarise(n=n(), fluo_focus=sum(all))

# mycells_switchingLow_memory %&gt;% ungroup() %&gt;% 
#   filter(gfp_start &gt; 2500 | fluo_focus) %&gt;%
#   select(date, pos, gl, genealogy, gfp_start, fluo_focus) %&gt;% print(n=Inf)

# mycells_switchingLow_memory %&gt;% 
#   mutate(lag_200=ifelse(lag_200/60 &gt; 300, Inf, lag_200),
#          gfp_inherit=ifelse(gfp_inherit&lt;1e-4, 1e-4, gfp_inherit) ) %&gt;% 
#   # pull(gfp_inherit) %&gt;% is.finite() %&gt;% all()
#   ggplot(aes(gfp_inherit)) + stat_ecdf() + scale_x_log10()
#   ggplot(aes(logl_time_slope_before, col=factor(date), lty=gfp_inherit&gt;30)) +
#   geom_freqpoly(binwidth=1e-5) +
#   coord_cartesian(xlim=c(0, 3e-4)) +
#   NULL</code></pre>
<p>Here are all lineages analysed in low lactose:</p>
<pre class="r"><code>(myplots[[&#39;lowLac_gfp_lineages&#39;]] &lt;- mycells_switchingLow_memory %&gt;% ungroup() %&gt;% 
  # filter(gfp_start &lt; 2500) %&gt;% 
  unnest(lineage) %&gt;% 
  select(date, pos, gl, fluo_focus, parent, time_sec, parent_gfp) %&gt;% 
  distinct() %&gt;% 
  ggplot(aes(time_sec, (parent_gfp+60) + 200)) +
  facet_grid(~date, scale=&#39;free_x&#39;, space=&#39;free_x&#39;) +
  geom_path(aes(group=interaction(pos, gl, parent), col=fluo_focus), alpha=0.4) +
  geom_hline(yintercept=200, lty=&#39;dashed&#39;) +
  scale_x_hours(2) +
  scale_y_continuous(trans=&#39;log2&#39;, limits=c(20, NA)) +
  # scale_y_continuous(limits=c(NA, 400)) +
  # scale_colour_periodic(guide=&#39;none&#39;) +
  labs(y = &quot;corrected LacZ-GFP level\n(molecules; with +200 offset)&quot; ) +
  theme(legend.position=&#39;top&#39;) +
  NULL)</code></pre>
<p><img src="MoM_lacInduction_lowLactose_files/figure-html/unnamed-chunk-6-1.svg" width="672" /></p>
<p>Let’s look at the induction lag as a function of the inherited LacZ-GFP.<br />
Data analysis revealed that virtually all cells descended from a mother cell with a LacZ-GFP focus (visible in fluorescence) have long lags despite their high LacZ-GFP level measurable at the switch. The reason for this remains unclear but we discard them from current analysis.</p>
<pre class="r"><code>(myplots[[&#39;lowLac_lags_inherited_gfp&#39;]] &lt;- mycells_switchingLow_memory %&gt;% 
  ungroup() %&gt;% 
  mutate(lag_200=ifelse(lag_200/60 &gt; 300, Inf, lag_200),
         gfp_inherit=ifelse(gfp_inherit&lt;.1, .1, gfp_inherit) ) %&gt;% 
  ggplot(aes(gfp_inherit, lag_200/60, shape=factor(date), col=fluo_focus)) +
  geom_hline(yintercept=65, lty=&#39;dotted&#39;) +
  geom_point(alpha=.5, stroke=0, position=position_jitter(), size=3) +
  scale_x_continuous(trans=&#39;log2&#39;) +
  expand_limits(y=0) +
  labs(x=&#39;inherited LacZ-GFP molecules&#39;, y=lac_lags_label, shape=&#39;date&#39;) +
  guides(col = guide_legend(override.aes = list(alpha = 1))) +
  theme(legend.position=&#39;top&#39;) +
  NULL)</code></pre>
<p><img src="MoM_lacInduction_lowLactose_files/figure-html/unnamed-chunk-7-1.svg" width="672" /></p>
<pre class="r"><code>(myplots[[&#39;lowLac_memory_frac_short&#39;]] &lt;- mycells_switchingLow_memory %&gt;% 
  filter(!fluo_focus) %&gt;% 
  mutate(lag_200=ifelse(lag_200/60 &gt; 300, Inf, lag_200),
         gfp_inherit=ifelse(gfp_inherit&lt;.1, .1, gfp_inherit),
         # gfp_inherit_bin=as.numeric(as.character(Hmisc::cut2(gfp_inherit, cuts=c(-Inf, 10^seq(-1.1, 3.8, .5)), levels.mean=TRUE))) ) %&gt;% 
         gfp_inherit_bin=as.numeric(as.character(Hmisc::cut2(gfp_inherit, cuts=c(-Inf, 10^seq(-.8, 2.5, .5)), levels.mean=TRUE))) ) %&gt;% 
  group_by(gfp_inherit_bin) %&gt;% 
  summarise(n=n(), prop=sum(lag_200/60&lt;65, na.rm=TRUE)/n, se=sqrt(prop*(1-prop)/n)) %&gt;% 
  ggplot(aes(gfp_inherit_bin, prop)) +
  geom_hline(yintercept=.28, lty=&#39;dashed&#39;) +
  geom_pointrange(aes(size=n, ymin=prop-se, ymax=prop+se) ) +
  scale_x_continuous(breaks=10^(0:3),
                     trans=scales::trans_new(name=&#39;log10_rev&#39;, 
                                             transform=function(x) -log(x, 10), 
                                             inverse=function(x) 10^(-x))
  ) +
  expand_limits(y=c(0, 1)) +
  scale_size_continuous(range=c(0.05, .5), breaks=c(20, 40, 80)) +
  labs(x=&#39;inherited LacZ-GFP molecules&#39;, y=&#39;fraction of short lags&#39;, size=&#39;sample size&#39;) +
  guides(size=guide_legend(direction=&#39;horizontal&#39;)) +
  theme(legend.position=&#39;top&#39;) +
  NULL)</code></pre>
<p><img src="MoM_lacInduction_lowLactose_files/figure-html/unnamed-chunk-9-1.svg" width="672" /></p>
<p>Last, we measure the growth rate after the switch in 0.01% lactose in order (1) to check that cells grow regularly, and (2) to compare the growth rate with 0.2% lactose.</p>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
